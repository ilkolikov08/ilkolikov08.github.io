"use strict";sap.ui.define(["sap/btp/ui5challange/controller/App.controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/m/SearchField","sap/ui/model/json/JSONModel"],function(e,t,i,r,a,l){"use strict";return e.extend("sap.btp.ui5challange.controller.Overview",{onInit:function e(){this._initLocalModel();this._initFilterBar()},_initLocalModel:function e(){var t=new l;var i=this.getOwnerComponent();t.loadData("./model/mock.json");i.setModel(t)},_initFilterBar:function e(){this.oFilterBar=this.byId("FilterBar");this.oBasicSearch=new a("BasicSearch",{liveChange:this.onSearch.bind(this)});this.oFilterBar.registerGetFiltersWithValues(this.fGetFiltersWithValues);this.oFilterBar.fireInitialise();this.oFilterBar.setBasicSearch(this.oBasicSearch)},onSearch:function e(r){var a=this.oFilterBar.getBasicSearchValue().trim();var l=this.oFilterBar._getFiltersWithValues();var n=a.length===0&&l.length===0;var o=this.byId("OverviewTable");var s=o.getBinding("items");var h=[];if(n)return s.filter([]);if(l.length>0){h=l.map(this.getModelFilters)}if(a.length>0){h.push(new t("app_id",i.Contains,a))}s.filter(new t(h,false))},fGetFiltersWithValues:function e(){var t=this;var i=this.getFilterGroupItems();var r=[];i.forEach(function(e){var i=t.determineControlByFilterItem(e);if(i&&i.getValue&&i.getValue()){r.push(e)}});return r},onClear:function e(t){var i=this.oFilterBar._getFiltersWithValues();var r=this.byId("OverviewTable");var a=r.getBinding("items");i.forEach(function(e){var t=e.getControl();t.setSelectedKey("")});this.oBasicSearch.setValue("");a.filter([])},getModelFilters:function e(r){var a=r.getControl();var l=a.data("filterProperty");var n=a.getSelectedKey()||a.getValue();var o=new t(l,i.EQ,n);return o},handleValueHelp:function e(t){var i=this;var a=this.getView();var l=t.getSource();this._sInputId=l.getId();if(!this._oSelectDialog){r.load({id:a.getId(),name:"sap.btp.ui5challange.view.fragments.Dialog",controller:this}).then(function(e){a.addDependent(e);i._oSelectDialog=e;i._oSelectDialog.open()})}else{this._oSelectDialog.open()}},handleSelectDialogSearch:function e(r){var a=r.getSource();var l=r.getParameter("value");var n=a.getBinding("items");var o=new t("assign_group",i.Contains,l);n.filter([o])},handleSelectDialogClose:function e(t){var i=t.getSource();var r=t.getParameter("selectedItem");var a=i.getBinding("items");if(r){var l=this.byId(this._sInputId);l.setValue(r.getTitle())}a.filter([]);this.oFilterBar.fireSearch(t)},onInputChange:function e(t){var i=t.getParameter("value").trim();if(i)return;this.oFilterBar.fireSearch(t)},handleSelectDialogCancel:function e(t){var i=t.getSource();var r=i.getBinding("items");r.filter([])}})});